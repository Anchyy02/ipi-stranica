<h2>ğŸ“Š Personal Trackers</h2>
<p>Odaberi tracker za praÄ‡enje svojih dnevnih navika:</p>

<div class="tracker-grid">
    <!-- Water Intake Tracker -->
    <div class="tracker-card active" (click)="openTracker('water')">
        <div class="tracker-icon">ğŸ’§</div>
        <h3>Water Intake</h3>
        <p>Prati unos vode tokom dana</p>
    </div>

    <!-- Time Tracker -->
    <div class="tracker-card active" (click)="openTracker('timer')">
        <div class="tracker-icon">â±ï¸</div>
        <h3>Time Tracker</h3>
        <p>Prati vrijeme unesenih zadataka</p>
    </div>

    <!-- Exercise Tracker -->
    <div class="tracker-card active" (click)="openTracker('exercise')">
        <div class="tracker-icon">ğŸƒ</div>
        <h3>Exercise Tracker</h3>
        <p>Prati minute vjeÅ¾banja</p>
    </div>

    <!-- Sleep Tracker -->
    <div class="tracker-card active" (click)="openTracker('sleep')">
        <div class="tracker-icon">ğŸ˜´</div>
        <h3>Sleep Tracker</h3>
        <p>Prati sate spavanja</p>
    </div>

    <!-- Study Hours Tracker -->
    <div class="tracker-card active" (click)="openTracker('study')">
        <div class="tracker-icon">ğŸ“š</div>
        <h3>Study Hours</h3>
        <p>Prati sate uÄenja</p>
    </div>

    <!-- Meal Tracker -->
    <div class="tracker-card active" (click)="openTracker('meal')">
        <div class="tracker-icon">ğŸ</div>
        <h3>Meal Tracker</h3>
        <p>Prati broj obroka</p>
    </div>
</div>

<!-- Water Tracker Modal -->
<div class="tracker-modal" [class.show]="showWaterModal" (click)="onModalClick($event)">
    <div class="tracker-modal-content">
        <span class="close-modal" (click)="closeTracker()">&times;</span>
        <h2>ğŸ’§ Water Intake Tracker</h2>
        <p>Koliko ÄaÅ¡a vode si popio danas?</p>

        <div class="water-input-section">
            <div class="today-section">
                <h3>Danas: <span>{{todayDate}}</span></h3>
                <div class="glass-counter">
                    <button class="btn-counter" (click)="decreaseGlasses()">-</button>
                    <div class="glass-display">
                        <span class="glass-count">{{todayGlasses}}</span>
                        <span class="glass-label">ÄaÅ¡a</span>
                    </div>
                    <button class="btn-counter" (click)="increaseGlasses()">+</button>
                </div>
                <p class="water-goal">Cilj: 8 ÄaÅ¡a dnevno</p>
            </div>
        </div>

        <div class="contribution-graph">
            <h3>Unos vode u poslednja 3 meseca</h3>
            <p style="font-size: 0.85rem; color: #6b7280; margin-bottom: 12px;">DanaÅ¡nji datum: <strong>{{getTodayDate()}}</strong></p>
            <div class="graph-container">
                <div class="month-labels">
                    <span *ngFor="let label of monthLabels" [style.grid-column]="(label.position + 1)">
                        {{label.text}}
                    </span>
                </div>
                <div class="graph-grid">
                    <div class="day-labels">
                        <span>Pon</span>
                        <span>Uto</span>
                        <span>Sri</span>
                        <span>ÄŒet</span>
                        <span>Pet</span>
                        <span>Sub</span>
                        <span>Ned</span>
                    </div>
                    <div class="graph-cells">
                        <div *ngFor="let cell of graphCells" 
                             class="graph-cell level-{{cell.level}}"
                             [class.today]="cell.isToday"
                             [title]="cell.date + ': ' + cell.glasses + ' ÄaÅ¡a' + (cell.isToday ? ' (DANAS)' : '')"
                             (click)="editDay(cell.date, cell.glasses)">
                        </div>
                    </div>
                </div>
            </div>
            <div class="legend">
                <span>Manje</span>
                <div class="legend-colors">
                    <span class="legend-cell level-0"></span>
                    <span class="legend-cell level-1"></span>
                    <span class="legend-cell level-2"></span>
                    <span class="legend-cell level-3"></span>
                    <span class="legend-cell level-4"></span>
                </div>
                <span>ViÅ¡e</span>
            </div>
        </div>

        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-number">{{weeklyAvg}}</div>
                <div class="stat-label">Nedeljni prosek</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{bestStreak}}</div>
                <div class="stat-label">Najbolji niz</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{totalDays}}</div>
                <div class="stat-label">Aktivnih dana</div>
            </div>
        </div>
    </div>
</div>

<!-- Time Tracker Modal -->
<div class="tracker-modal" [class.show]="showTimerModal" (click)="onModalClick($event)">
    <div class="tracker-modal-content">
        <span class="close-modal" (click)="closeTimerModal()">&times;</span>
        <h2>â±ï¸ Time Tracker</h2>
        <p>Prati vrijeme utroÅ¡eno na razliÄite aktivnosti</p>

        <!-- Active Timer Display -->
        <div class="active-timer-section" *ngIf="activeEntry">
            <div class="active-timer-card">
                <div class="timer-badge running">Aktivno</div>
                <h3>{{ activeEntry.title }}</h3>
                <div class="category-badge">
                    {{ getCategoryIcon(activeEntry.category) }} {{ getCategoryLabel(activeEntry.category) }}
                </div>
                <div class="timer-display">{{ currentElapsedTime() }}</div>

                <div class="glass-counter">
                    <button class="btn-counter" (click)="decreaseActiveTime()">-</button>
                    <div class="glass-display">
                        <span class="glass-count">{{ TIME_ADJUST_STEP_MINUTES }}</span>
                        <span class="glass-label">min korak</span>
                    </div>
                    <button class="btn-counter" (click)="increaseActiveTime()">+</button>
                </div>

                <button class="btn-stop" (click)="stopTimer(activeEntry.id!)">
                    â¸ï¸ Zaustavi Timer
                </button>
            </div>
        </div>

        <!-- New Timer Form -->
        <div class="new-timer-section">
            <h3>{{ activeEntry ? 'Pokreni novi timer' : 'Pokreni timer' }}</h3>
            <div class="form-group">
                <input 
                    type="text" 
                    [(ngModel)]="newEntryTitle"
                    placeholder="Å to radiÅ¡? (npr. 'UÄenje matematike')"
                    class="form-input">
            </div>
            <div class="form-group">
                <select [(ngModel)]="newEntryCategory" class="form-select">
                    <option value="study">ğŸ“š UÄenje</option>
                    <option value="work">ğŸ’¼ Posao</option>
                    <option value="exercise">ğŸƒ VjeÅ¾banje</option>
                    <option value="other">ğŸ“ Ostalo</option>
                </select>
            </div>
            <button class="btn-start" (click)="startNewTimer()">
                â–¶ï¸ Pokreni Timer
            </button>
        </div>

        <!-- Today's Summary -->
        <div class="today-summary">
            <h3>ğŸ“… Danas ukupno</h3>
            <div class="summary-time">{{ getTodayTotalTime() }}</div>
            <p class="summary-label">Ukupno vrijeme danas</p>
        </div>

        <!-- Time Entries List -->
        <div class="time-entries-section">
            <h3>ğŸ“‹ Povijest unosa</h3>
            <div class="entries-list" *ngIf="timeEntries.length > 0">
                <div 
                    class="time-entry" 
                    *ngFor="let entry of timeEntries"
                    [class.running]="entry.isRunning">
                    
                    <div class="entry-header">
                        <div class="entry-icon">{{ getCategoryIcon(entry.category) }}</div>
                        <div class="entry-info">
                            <h4>{{ entry.title }}</h4>
                            <div class="entry-meta">
                                <span class="entry-category">{{ getCategoryLabel(entry.category) }}</span>
                                <span class="entry-time">
                                    {{ entry.startTime | date:'HH:mm, dd.MM.yyyy' }}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="entry-duration" [class.running]="entry.isRunning">
                        {{ getEntryDuration(entry) }}
                    </div>

                    <div class="entry-actions">
                        <button 
                            *ngIf="!entry.isRunning" 
                            class="btn-icon resume"
                            (click)="resumeTimer(entry.id!)"
                            title="Nastavi">
                            â–¶ï¸
                        </button>
                        <button 
                            class="btn-icon delete"
                            (click)="deleteEntry(entry.id!)"
                            title="ObriÅ¡i">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="empty-state" *ngIf="timeEntries.length === 0">
                <span class="empty-icon">â±ï¸</span>
                <p>NemaÅ¡ joÅ¡ evidencija vremena. Pokreni prvi timer!</p>
            </div>
        </div>
    </div>
</div>

<!-- Exercise Tracker Modal -->
<div class="tracker-modal" [class.show]="showExerciseModal" (click)="onModalClick($event)">
    <div class="tracker-modal-content">
        <span class="close-modal" (click)="closeTracker()">&times;</span>
        <h2>ğŸƒ Exercise Tracker</h2>
        <p>Koliko minuta vjeÅ¾banja danas?</p>

        <div class="water-input-section">
            <div class="today-section">
                <h3>Danas: <span>{{todayDate}}</span></h3>
                <div class="glass-counter">
                    <button class="btn-counter" (click)="decreaseExercise()">-</button>
                    <div class="glass-display">
                        <span class="glass-count">{{todayExerciseMinutes}}</span>
                        <span class="glass-label">min</span>
                    </div>
                    <button class="btn-counter" (click)="increaseExercise()">+</button>
                </div>
                <p class="water-goal">Korak: 5 minuta</p>
            </div>
        </div>

        <div class="simple-history">
            <h3>Poslednjih 7 dana</h3>
            <div class="history-list" *ngIf="exerciseHistory.length > 0; else noExercise">
                <div class="history-row" *ngFor="let item of exerciseHistory">
                    <span class="history-date">{{ formatShortDate(item.date) }}</span>
                    <span class="history-value">{{ item.value }} min</span>
                </div>
            </div>
            <ng-template #noExercise>
                <div class="empty-state">
                    <span class="empty-icon">ğŸƒ</span>
                    <p>Nema unosa joÅ¡.</p>
                </div>
            </ng-template>
        </div>
    </div>
</div>

<!-- Sleep Tracker Modal -->
<div class="tracker-modal" [class.show]="showSleepModal" (click)="onModalClick($event)">
    <div class="tracker-modal-content">
        <span class="close-modal" (click)="closeTracker()">&times;</span>
        <h2>ğŸ˜´ Sleep Tracker</h2>
        <p>Koliko sati spavanja danas?</p>

        <div class="water-input-section">
            <div class="today-section">
                <h3>Danas: <span>{{todayDate}}</span></h3>
                <div class="glass-counter">
                    <button class="btn-counter" (click)="decreaseSleep()">-</button>
                    <div class="glass-display">
                        <span class="glass-count">{{todaySleepHours}}</span>
                        <span class="glass-label">h</span>
                    </div>
                    <button class="btn-counter" (click)="increaseSleep()">+</button>
                </div>
                <p class="water-goal">Korak: 0.5h</p>
            </div>
        </div>

        <div class="simple-history">
            <h3>Poslednjih 7 dana</h3>
            <div class="history-list" *ngIf="sleepHistory.length > 0; else noSleep">
                <div class="history-row" *ngFor="let item of sleepHistory">
                    <span class="history-date">{{ formatShortDate(item.date) }}</span>
                    <span class="history-value">{{ item.value }} h</span>
                </div>
            </div>
            <ng-template #noSleep>
                <div class="empty-state">
                    <span class="empty-icon">ğŸ˜´</span>
                    <p>Nema unosa joÅ¡.</p>
                </div>
            </ng-template>
        </div>
    </div>
</div>

<!-- Study Tracker Modal -->
<div class="tracker-modal" [class.show]="showStudyModal" (click)="onModalClick($event)">
    <div class="tracker-modal-content">
        <span class="close-modal" (click)="closeTracker()">&times;</span>
        <h2>ğŸ“š Study Hours</h2>
        <p>Koliko sati uÄenja danas?</p>

        <div class="water-input-section">
            <div class="today-section">
                <h3>Danas: <span>{{todayDate}}</span></h3>
                <div class="glass-counter">
                    <button class="btn-counter" (click)="decreaseStudy()">-</button>
                    <div class="glass-display">
                        <span class="glass-count">{{todayStudyHours}}</span>
                        <span class="glass-label">h</span>
                    </div>
                    <button class="btn-counter" (click)="increaseStudy()">+</button>
                </div>
                <p class="water-goal">Korak: 0.5h</p>
            </div>
        </div>

        <div class="simple-history">
            <h3>Poslednjih 7 dana</h3>
            <div class="history-list" *ngIf="studyHistory.length > 0; else noStudy">
                <div class="history-row" *ngFor="let item of studyHistory">
                    <span class="history-date">{{ formatShortDate(item.date) }}</span>
                    <span class="history-value">{{ item.value }} h</span>
                </div>
            </div>
            <ng-template #noStudy>
                <div class="empty-state">
                    <span class="empty-icon">ğŸ“š</span>
                    <p>Nema unosa joÅ¡.</p>
                </div>
            </ng-template>
        </div>
    </div>
</div>

<!-- Meal Tracker Modal -->
<div class="tracker-modal" [class.show]="showMealModal" (click)="onModalClick($event)">
    <div class="tracker-modal-content">
        <span class="close-modal" (click)="closeTracker()">&times;</span>
        <h2>ğŸ Meal Tracker</h2>
        <p>Koliko obroka danas?</p>

        <div class="water-input-section">
            <div class="today-section">
                <h3>Danas: <span>{{todayDate}}</span></h3>
                <div class="glass-counter">
                    <button class="btn-counter" (click)="decreaseMeals()">-</button>
                    <div class="glass-display">
                        <span class="glass-count">{{todayMeals}}</span>
                        <span class="glass-label">obroka</span>
                    </div>
                    <button class="btn-counter" (click)="increaseMeals()">+</button>
                </div>
                <p class="water-goal">Korak: 1</p>
            </div>
        </div>

        <div class="simple-history">
            <h3>Poslednjih 7 dana</h3>
            <div class="history-list" *ngIf="mealHistory.length > 0; else noMeals">
                <div class="history-row" *ngFor="let item of mealHistory">
                    <span class="history-date">{{ formatShortDate(item.date) }}</span>
                    <span class="history-value">{{ item.value }} obroka</span>
                </div>
            </div>
            <ng-template #noMeals>
                <div class="empty-state">
                    <span class="empty-icon">ğŸ</span>
                    <p>Nema unosa joÅ¡.</p>
                </div>
            </ng-template>
        </div>
    </div>
</div>
